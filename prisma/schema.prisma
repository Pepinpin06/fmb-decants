// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Order {
  id              Int           @id @default(autoincrement()) // Human friendly ID
  // orderNumber removed (id is now the number)
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  
  // Status
  status          String        @default("PENDING") // PENDING, PAID, SHIPPED, COMPLETED, CANCELLED
  paymentStatus   String        @default("UNPAID")
  paymentId       String?       // PayPal Order ID
  
  // Shipping Data
  shippingCost    Float
  shippingProvider String?
  trackingNumber  String?

  // Financials
  subtotal        Float
  total           Float

  // Relations
  items           OrderItem[]
  shippingAddress ShippingAddress?
  
  // Customer Info (Denormalized or Relation)
  customerEmail   String
  customerPhone   String?
  customerName    String
}

model OrderItem {
  id        String  @id @default(cuid())
  orderId   Int
  order     Order   @relation(fields: [orderId], references: [id])
  
  productId String  // Allow loose coupling with hardcoded product list
  name      String
  size      Int     // 3, 5, 10
  price     Float
  quantity  Int
  image     String?
}

model ShippingAddress {
  id              String @id @default(cuid())
  orderId         Int    @unique
  order           Order  @relation(fields: [orderId], references: [id])
  
  firstName       String
  lastName        String
  email           String
  phone           String
  
  street          String
  exteriorNumber  String?
  interiorNumber  String?
  colonia         String
  city            String
  state           String
  zipCode         String
  references      String?
  
  isOcurre        Boolean @default(false)
}
